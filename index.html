<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新笑傲江湖 - 金庸正版武侠手游</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- GSAP 动画库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#8B0000', // 深红色
                        secondary: '#D4AF37', // 金色
                        dark: '#1A0000',
                        light: '#F5F5DC'
                    },
                    fontFamily: {
                        sans: ['Arial', 'sans-serif'],
                        serif: ['"Times New Roman"', 'serif'],
                        cursive: ['"Ma Shan Zheng"', 'cursive']
                    },
                    backgroundImage: {
                        'hero-pattern': "url('./生成武侠图0.png')",
                        // 'snow-pattern': "url('https://example.com/snow.png')",
                        // 'hero-pattern': "url('https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/7a35b2cf089c4bf8bc4710b8a9dc09ed~tplv-a9rns2rl98-image.image?rcl=202511052032503C43E9BEC6809DDC4429&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1764937993&x-signature=seRlwySQ7Nw%2Bi2q8Txe1mcZq7e0%3D')"
                    }   
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            }
            .text-stroke {
                -webkit-text-stroke: 1px #D4AF37;
            }
            .bg-overlay {
                background-color: rgba(0, 0, 0, 0.5);
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .animate-float {
                animation: float 6s ease-in-out infinite;
            }
            @keyframes float {
                0% { transform: translateY(0px); }
                50% { transform: translateY(-20px); }
                100% { transform: translateY(0px); }
            }
            .ink-splash {
                position: relative;
                overflow: hidden;
            }
            .ink-splash::after {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                width: 0;
                height: 0;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 50%;
                transform: translate(-50%, -50%);
                transition: width 0.6s, height 0.6s;
            }
            .ink-splash:active::after {
                width: 300px;
                height: 300px;
            }
        }
    </style>
    <!-- 引入中文字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap" rel="stylesheet">
</head>
<body class="bg-dark text-light overflow-x-hidden">
    <!-- 导航栏 -->
    <nav class="fixed top-0 left-0 w-full z-50 transition-all duration-300" id="navbar">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center">
                <!-- <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/8f0d411dc5f242068abab58c7fded263~tplv-a9rns2rl98-image.image?rcl=202511052032503C43E9BEC6809DDC4429&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1764937992&x-signature=7z3URAMmwrq1w%2FGD9I%2BTx9Om2ig%3D" alt="武侠魂" class="h-12 mr-3"> -->
                <span class="text-2xl font-cursive text-secondary">网页示例</span>
            </div>
            <div class="hidden:hidden md:flex space-x-8">
                <a href="#home" class="text-secondary hover:text-white transition-colors">首页</a>
                <a href="#features" class="text-secondary hover:text-white transition-colors">游戏特色</a>
                <a href="#characters" class="text-secondary hover:text-white transition-colors">角色展示</a>
                <a href="#scenes" class="text-secondary hover:text-white transition-colors">游戏场景</a>
                <a href="#download" class="text-secondary hover:text-white transition-colors">立即下载</a>
            </div>
            <div class="md:hidden">
                <button id="menu-toggle" class="text-secondary focus:outline-none">
                    <i class="fa fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
        <!-- 移动端菜单 -->
        <div id="mobile-menu" class="hidden md:hidden bg-dark bg-opacity-95 w-full">
            <div class="container mx-auto px-4 py-3 flex flex-col space-y-4">
                <a href="#home" class="text-secondary hover:text-white transition-colors py-2 border-b border-gray-800">首页</a>
                <a href="#features" class="text-secondary hover:text-white transition-colors py-2 border-b border-gray-800">游戏特色</a>
                <a href="#characters" class="text-secondary hover:text-white transition-colors py-2 border-b border-gray-800">角色展示</a>
                <a href="#scenes" class="text-secondary hover:text-white transition-colors py-2 border-b border-gray-800">游戏场景</a>
                <a href="#download" class="text-secondary hover:text-white transition-colors py-2">立即下载</a>
            </div>
        </div>
    </nav>

    <!-- 英雄区 -->
    <section id="home" class="relative h-screen bg-hero-pattern bg-cover bg-center flex items-center justify-center">
       <!-- 飘雪动画画布 -->
        <canvas id="snowCanvas" class="absolute inset-0 w-full h-full pointer-events-none opacity-70"></canvas>
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="container mx-auto px-4 z-10 text-center">
            <h1 class="text-5xl md:text-7xl font-cursive text-secondary mb-4 animate__animated animate__fadeInDown" id="main-title">新笑傲江湖</h1>
            <p class="text-2xl md:text-4xl font-cursive text-white mb-8 animate__animated animate__fadeInUp" id="subtitle">官方正版金庸武侠手游</p>
            <div class="flex justify-center space-x-4 animate__animated animate__fadeInUp" id="hero-buttons">
                <button class="bg-primary hover:bg-opacity-80 text-white font-bold py-3 px-8 rounded-full transition-all duration-300 transform hover:scale-105 ink-splash">
                    <i class="fa fa-download mr-2"></i>立即下载
                </button>
                <button class="bg-transparent border-2 border-secondary text-secondary hover:bg-secondary hover:text-dark font-bold py-3 px-8 rounded-full transition-all duration-300 transform hover:scale-105 ink-splash">
                    <i class="fa fa-play-circle mr-2"></i>观看宣传片
                </button>
            </div>
        </div>
        <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce">
            <a href="#features" class="text-white text-3xl">
                <i class="fa fa-angle-down"></i>
            </a>
        </div>
    </section>

    <!-- 游戏特色 -->
    <section id="features" class="py-20 bg-gradient-to-b from-dark to-primary">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-cursive text-secondary text-center mb-16">游戏特色</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- 特色1 -->
                <div class="bg-dark bg-opacity-50 p-8 rounded-lg transform transition-all duration-300 hover:scale-105 hover:shadow-lg">
                    <div class="w-16 h-16 bg-secondary bg-opacity-20 rounded-full flex items-center justify-center mb-6 mx-auto">
                            <i class="fa fa-book text-2xl text-secondary"></i>
                        </div>
                    <h3 class="text-2xl font-cursive text-secondary text-center mb-4">官方正版授权</h3>
                    <p class="text-center">完整还原金庸十五部经典武侠小说，原汁原味的武侠世界，带你重温经典剧情。</p>
                </div>
                <!-- 特色2 -->
                <div class="bg-dark bg-opacity-50 p-8 rounded-lg transform transition-all duration-300 hover:scale-105 hover:shadow-lg">
                    <div class="w-16 h-16 bg-secondary bg-opacity-20 rounded-full flex items-center justify-center mb-6 mx-auto">
                         <i class="fa fa-crosshairs text-2xl text-secondary"></i>
                    </div>
                    <h3 class="text-2xl font-cursive text-secondary text-center mb-4">特色武侠技能</h3>
                    <p class="text-center">独特的武侠技能系统，轻功、内功、外功相结合，打造属于你的独门武功。</p>
                </div>
                <!-- 特色3 -->
                <div class="bg-dark bg-opacity-50 p-8 rounded-lg transform transition-all duration-300 hover:scale-105 hover:shadow-lg">
                    <div class="w-16 h-16 bg-secondary bg-opacity-20 rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i class="fa fa-users text-2xl text-secondary"></i>
                    </div>
                    <h3 class="text-2xl font-cursive text-secondary text-center mb-4">多人江湖互动</h3>
                    <p class="text-center">组队副本、帮派战、武林大会，与其他玩家一起体验江湖恩怨情仇。</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 角色展示 -->
        <section id="characters" class="py-20 bg-dark">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-['Liu_Jian_Mao_Cao'] text-secondary text-center mb-16">角色展示</h2>
            <div class="relative">
                <div class="character-slider flex overflow-x-auto scrollbar-hide pb-8 snap-x snap-mandatory">
                    <!-- 角色1 -->
                    <div class="character-card flex-shrink-0 w-full md:w-1/2 lg:w-1/3 snap-center px-4">
                        <div class="bg-gradient-to-br from-primary to-dark rounded-lg overflow-hidden shadow-xl transform transition-all duration-300 hover:scale-105">
                            <img src='./生成武侠图.png'>
                            <div class="p-6">
                                <h3 class="text-2xl font-['Liu_Jian_Mao_Cao'] text-secondary mb-2">乔峰</h3>
                                <p class="text-gray-300 mb-4">丐帮帮主，外号"北乔峰"，武功盖世，为人豪迈洒脱，重情重义。</p>
                                <div class="flex justify-between items-center">
                                    <div class="flex space-x-2">
                                        <span class="bg-secondary bg-opacity-20 text-secondary text-xs px-2 py-1 rounded">丐帮</span>
                                        <span class="bg-secondary bg-opacity-20 text-secondary text-xs px-2 py-1 rounded">降龙十八掌</span>
                                    </div>
                                    <button class="text-secondary hover:text-white transition-colors">
                                        <i class="fa fa-info-circle"></i> 详情
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 角色2 -->
                    <div class="character-card flex-shrink-0 w-full md:w-1/2 lg:w-1/3 snap-center px-4">
                        <div class="bg-gradient-to-br from-primary to-dark rounded-lg overflow-hidden shadow-xl transform transition-all duration-300 hover:scale-105">
                            <img src="./生成武侠图1.png">
                            <div class="p-6">
                                <h3 class="text-2xl font-['Liu_Jian_Mao_Cao'] text-secondary mb-2">令狐冲</h3>
                                <p class="text-gray-300 mb-4">华山派大弟子，后任恒山派掌门，性格放浪不羁，精通独孤九剑。</p>
                                <div class="flex justify-between items-center">
                                    <div class="flex space-x-2">
                                        <span class="bg-secondary bg-opacity-20 text-secondary text-xs px-2 py-1 rounded">华山派</span>
                                        <span class="bg-secondary bg-opacity-20 text-secondary text-xs px-2 py-1 rounded">独孤九剑</span>
                                    </div>
                                    <button class="text-secondary hover:text-white transition-colors">
                                        <i class="fa fa-info-circle"></i> 详情
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 角色3 -->
                    <div class="character-card flex-shrink-0 w-full md:w-1/2 lg:w-1/3 snap-center px-4">
                        <div class="bg-gradient-to-br from-primary to-dark rounded-lg overflow-hidden shadow-xl transform transition-all duration-300 hover:scale-105">
                            <img src="./生成武侠图2.png">
                            <div class="p-6">
                                <h3 class="text-2xl font-['Liu_Jian_Mao_Cao'] text-secondary mb-2">杨过</h3>
                                <p class="text-gray-300 mb-4">古墓派传人，外号"神雕大侠"，痴情专一，练就黯然销魂掌。</p>
                                <div class="flex justify-between items-center">
                                    <div class="flex space-x-2">
                                        <span class="bg-secondary bg-opacity-20 text-secondary text-xs px-2 py-1 rounded">古墓派</span>
                                        <span class="bg-secondary bg-opacity-20 text-secondary text-xs px-2 py-1 rounded">黯然销魂掌</span>
                                    </div>
                                    <button class="text-secondary hover:text-white transition-colors">
                                        <i class="fa fa-info-circle"></i> 详情
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    <!-- 角色4 -->
                
                <!-- 滑动指示器 -->
                <div class="flex justify-center mt-8 space-x-2">
                    <button class="w-3 h-3 rounded-full bg-secondary"></button>
                    <button class="w-3 h-3 rounded-full bg-gray-600"></button>
                    <button class="w-3 h-3 rounded-full bg-gray-600"></button>
                </div>
            </div>
        </div>
    </section>

    <!-- 游戏场景 -->
    <section id="scenes" class="py-20 bg-gradient-to-b from-primary to-dark">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-cursive text-secondary text-center mb-16">游戏场景</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- 场景1 -->
                <div class="scene-card relative overflow-hidden rounded-lg group">
                    <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/7a35b2cf089c4bf8bc4710b8a9dc09ed~tplv-a9rns2rl98-image.image?rcl=202511052032503C43E9BEC6809DDC4429&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1764937993&x-signature=seRlwySQ7Nw%2Bi2q8Txe1mcZq7e0%3D" alt="游戏场景" class="w-full h-80 object-cover transition-transform duration-500 group-hover:scale-110">
                    <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent opacity-70"></div>
                    <div class="absolute bottom-0 left-0 p-6">
                        <h3 class="text-2xl font-cursive text-secondary mb-2">华山之巅</h3>
                        <p class="text-white">华山论剑之地，云雾缭绕，山势险峻，是武林高手对决的绝佳场所。</p>
                    </div>
                </div>
                <!-- 场景2 -->
                <div class="scene-card relative overflow-hidden rounded-lg group">
                    <img src="./生成武侠图4.png" alt="游戏场景" class="w-full h-80 object-cover transition-transform duration-500 group-hover:scale-110">
                    <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent opacity-70"></div>
                    <div class="absolute bottom-0 left-0 p-6">
                        <h3 class="text-2xl font-cursive text-secondary mb-2">桃花岛</h3>
                        <p class="text-white">黄药师隐居之地，岛上桃花盛开，风景秀丽，机关遍布。</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 下载区域 -->
    <section id="download" class="py-20 bg-dark relative overflow-hidden">
        <div class="absolute inset-0 opacity-10">
            <div class="absolute top-0 left-0 w-full h-full bg-[url('https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/7a35b2cf089c4bf8bc4710b8a9dc09ed~tplv-a9rns2rl98-image.image?rcl=202511052032503C43E9BEC6809DDC4429&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1764937993&x-signature=seRlwySQ7Nw%2Bi2q8Txe1mcZq7e0%3D')] bg-cover bg-center"></div>
        </div>
        <div class="container mx-auto px-4 relative z-10">
            <div class="flex flex-col md:flex-row items-center justify-between">
                <div class="md:w-1/2 mb-10 md:mb-0">
                    <h2 class="text-4xl font-cursive text-secondary mb-6">立即下载</h2>
                    <p class="text-xl mb-8">加入新笑傲江湖，体验最纯正的金庸武侠世界！</p>
                    <div class="flex flex-wrap gap-4">
                        <button class="bg-secondary hover:bg-opacity-80 text-dark font-bold py-3 px-6 rounded-full transition-all duration-300 transform hover:scale-105 flex items-center ink-splash">
                            <i class="fa fa-android text-2xl mr-2"></i> Android
                        </button>
                        <button class="bg-secondary hover:bg-opacity-80 text-dark font-bold py-3 px-6 rounded-full transition-all duration-300 transform hover:scale-105 flex items-center ink-splash">
                            <i class="fa fa-apple text-2xl mr-2"></i> iOS
                        </button>
                        <button class="bg-secondary hover:bg-opacity-80 text-dark font-bold py-3 px-6 rounded-full transition-all duration-300 transform hover:scale-105 flex items-center ink-splash">
                            <i class="fa fa-desktop text-2xl mr-2"></i> PC
                        </button>
                    </div>
                </div>
                <div class="md:w-1/2 flex justify-center">
                    <div class="relative animate-float">
                        <img src="./生成武侠图5.png" alt="武侠角色" class="w-64 md:w-80 rounded-lg shadow-2xl">
                        <div class="absolute -top-4 -right-4 bg-primary text-white px-4 py-2 rounded-full transform rotate-12 shadow-lg">
                            敬请期待
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="bg-dark border-t border-gray-800 py-10">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0">
                    <div class="flex items-center">
                        <!-- <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/8f0d411dc5f242068abab58c7fded263~tplv-a9rns2rl98-image.image?rcl=202511052032503C43E9BEC6809DDC4429&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1764937992&x-signature=7z3URAMmwrq1w%2FGD9I%2BTx9Om2ig%3D" alt="武侠魂" class="h-10 mr-3"> -->
                        <span class="text-xl font-cursive text-secondary">新笑傲江湖</span>
                    </div>
                    <p class="text-gray-400 mt-2">官方正版武侠手游</p>
                </div>
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-400 hover:text-secondary transition-colors">
                        <i class="fa fa-weibo text-2xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-secondary transition-colors">
                        <i class="fa fa-wechat text-2xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-secondary transition-colors">
                        <i class="fa fa-qq text-2xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-secondary transition-colors">
                        <i class="fa fa-youtube-play text-2xl"></i>
                    </a>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-500 text-sm">
                <p>© 2025 新笑傲江湖 版权所有:Zhb | 金庸正版授权</p>
            </div>
        </div>
    </footer>

    <!-- 返回顶部按钮 -->
    <button id="back-to-top" class="fixed bottom-8 right-8 bg-secondary text-dark w-12 h-12 rounded-full flex items-center justify-center shadow-lg opacity-0 invisible transition-all duration-300">
        <i class="fa fa-arrow-up"></i>
    </button>

    <!-- 游戏预告片模态框
    <div id="trailer-modal" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center hidden">
        <div class="relative w-full max-w-4xl mx-4">
            <button id="close-modal" class="absolute -top-10 right-0 text-white text-2xl hover:text-secondary transition-colors">
                <i class="fa fa-times"></i>
            </button>
            <div class="bg-dark rounded-lg overflow-hidden">
                <div class="aspect-w-16 aspect-h-9 bg-black bg-opacity-50 flex items-center justify-center">
                    <i class="fa fa-play-circle text-6xl text-secondary"></i>
                    <p class="text-white mt-4">游戏预告片将在此播放</p>
                </div>
            </div>
        </div>
    </div> -->

    <!-- 游戏预告片模态框（修改后） -->
<div id="trailer-modal" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center hidden">
    <div class="relative w-full max-w-4xl mx-4">
        <button id="close-modal" class="absolute -top-10 right-0 text-white text-2xl hover:text-secondary transition-colors z-10">
            <i class="fa fa-times"></i>
        </button>
        <div class="bg-dark rounded-lg overflow-hidden shadow-2xl">
            <!-- 视频播放区域 -->
            <div class="aspect-w-16 aspect-h-9 relative">
                <!-- 方案1：使用自有视频（MP4格式） -->
                <video id="game-trailer" class="w-full h-full object-contain">
                    <source src="pv.mp4" type="video/mp4">
                    您的浏览器不支持视频播放
                </video>

                <!-- 方案2：嵌入B站/YouTube视频（推荐，减轻服务器压力） -->
                <!-- 替换为你的视频嵌入代码 -->
                <!-- <iframe 
                    src="https://player.bilibili.com/player.html?aid=123456&cid=7890123&page=1" 
                    scrolling="no" 
                    border="0" 
                    frameborder="no" 
                    framespacing="0" 
                    allowfullscreen="true"
                    class="w-full h-full"
                ></iframe> -->
            </div>
        </div>
    </div>
</div>
    <script>
        // 导航栏滚动效果
        const navbar = document.getElementById('navbar');
        const backToTop = document.getElementById('back-to-top');
        
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('bg-dark', 'bg-opacity-95', 'shadow-lg');
                navbar.classList.remove('py-3');
                navbar.classList.add('py-2');
                
                backToTop.classList.remove('opacity-0', 'invisible');
                backToTop.classList.add('opacity-100', 'visible');
            } else {
                navbar.classList.remove('bg-dark', 'bg-opacity-95', 'shadow-lg');
                navbar.classList.remove('py-2');
                navbar.classList.add('py-3');
                
                backToTop.classList.add('opacity-0', 'invisible');
                backToTop.classList.remove('opacity-100', 'visible');
            }
        });
        
        // 移动端菜单切换
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        
        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                    
                    // 如果是移动端，点击后关闭菜单
                    if (window.innerWidth < 768) {
                        mobileMenu.classList.add('hidden');
                    }
                }
            });
        });
        <!-- 角色卡片滑动指示器同步（新增代码） -->
const characterSlider = document.querySelector('.character-slider');
const indicatorButtons = document.querySelectorAll('.flex.justify-center.mt-8 button');
const characterCards = document.querySelectorAll('.character-card');

// 计算单个卡片的宽度（包含间距）
function getCardWidth() {
  // 卡片宽度 + 左右padding（每个卡片有px-4，即左右各4px）
  return characterCards[0].offsetWidth + 32; // 32 = 4px*2*4（px-4是16px的padding，左右各8px）
}

// 更新指示器状态
function updateIndicators() {
  const scrollLeft = characterSlider.scrollLeft;
  const cardWidth = getCardWidth();
  // 计算当前显示的卡片索引（四舍五入）
  const currentIndex = Math.round(scrollLeft / cardWidth);
  
  // 确保索引在有效范围内
  const validIndex = Math.min(Math.max(currentIndex, 0), indicatorButtons.length - 1);
  
  // 更新指示器样式
  indicatorButtons.forEach((button, index) => {
    if (index === validIndex) {
      button.classList.remove('bg-gray-600');
      button.classList.add('bg-secondary');
    } else {
      button.classList.remove('bg-secondary');
      button.classList.add('bg-gray-600');
    }
  });
}

// 监听滑动事件，实时更新指示器
characterSlider.addEventListener('scroll', updateIndicators);

// 初始化指示器状态
updateIndicators();

// 原有指示器点击事件（保持不变，补充滑动同步）
indicatorButtons.forEach((button, index) => {
  button.addEventListener('click', () => {
    const cardWidth = getCardWidth();
    characterSlider.scrollTo({
      left: cardWidth * index,
      behavior: 'smooth'
    });
    // 手动触发一次更新（确保动画结束后状态正确）
    setTimeout(updateIndicators, 500);
  });
});
        
        // 返回顶部按钮
        backToTop.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // 预告片模态框控制（新增视频控制逻辑）
const trailerModal = document.getElementById('trailer-modal');
const closeModal = document.getElementById('close-modal');
const trailerButtons = document.querySelectorAll('button:has(.fa-play-circle)');
const gameTrailer = document.getElementById('game-trailer'); // 获取视频元素

// 打开模态框并播放视频
trailerButtons.forEach(button => {
    button.addEventListener('click', () => {
        trailerModal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
        
        // 若为自有视频，尝试自动播放（受浏览器政策限制，可能需要用户交互）
        if (gameTrailer) {
            gameTrailer.play().catch(err => {
                console.log('自动播放失败，需用户交互后播放:', err);
            });
        }
    });
});

// 关闭模态框并暂停视频
function closeTrailerModal() {
    trailerModal.classList.add('hidden');
    document.body.style.overflow = 'auto';
    
    // 暂停视频
    if (gameTrailer) {
        gameTrailer.pause();
    }
}

closeModal.addEventListener('click', closeTrailerModal);

// 点击模态框外部关闭
trailerModal.addEventListener('click', (e) => {
    if (e.target === trailerModal) {
        closeTrailerModal();
    }
});

// 按ESC键关闭
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && !trailerModal.classList.contains('hidden')) {
        closeTrailerModal();
    }
});

// // 预告片模态框
// const trailerModal = document.getElementById('trailer-modal');
        // const closeModal = document.getElementById('close-modal');
        // const trailerButtons = document.querySelectorAll('button:has(.fa-play-circle)');
        
        // trailerButtons.forEach(button => {
        //     button.addEventListener('click', () => {
        //         trailerModal.classList.remove('hidden');
        //         document.body.style.overflow = 'hidden';
        //     });
        // });
        
        // closeModal.addEventListener('click', () => {
        //     trailerModal.classList.add('hidden');
        //     document.body.style.overflow = 'auto';
        // });
        
        // // 点击模态框外部关闭
        // trailerModal.addEventListener('click', (e) => {
        //     if (e.target === trailerModal) {
        //         trailerModal.classList.add('hidden');
        //         document.body.style.overflow = 'auto';
        //     }
        // });
        
        // 角色卡片滑动指示器 — 已在上方定义并初始化，避免重复声明和绑定事件。
        
        // 初始化GSAP动画
        document.addEventListener('DOMContentLoaded', () => {
            // 注册ScrollTrigger插件
            gsap.registerPlugin(ScrollTrigger);
            
            // 英雄区标题动画
            gsap.from('#main-title', {
                opacity: 0,
                y: 50,
                duration: 1,
                delay: 0.2
            });
            
            gsap.from('#subtitle', {
                opacity: 0,
                y: 50,
                duration: 1,
                delay: 0.5
            });
            
            gsap.from('#hero-buttons', {
                opacity: 0,
                y: 50,
                duration: 1,
                delay: 0.8
            });
            
            // 游戏特色动画
            gsap.utils.toArray('#features .grid > div').forEach((feature, i) => {
                gsap.from(feature, {
                    scrollTrigger: {
                        trigger: feature,
                        start: 'top 80%',
                        toggleActions: 'play none none none'
                    },
                    opacity: 0,
                    y: 50,
                    duration: 0.8,
                    delay: i * 0.2
                });
            });
            
            // 角色卡片动画
            gsap.utils.toArray('#characters .character-card').forEach((card, i) => {
                gsap.from(card, {
                    scrollTrigger: {
                        trigger: card,
                        start: 'top 80%',
                        toggleActions: 'play none none none'
                    },
                    opacity: 0,
                    y: 50,
                    duration: 0.8,
                    delay: i * 0.2
                });
            });
            
            // 游戏场景动画
            gsap.utils.toArray('#scenes .scene-card').forEach((scene, i) => {
                gsap.from(scene, {
                    scrollTrigger: {
                        trigger: scene,
                        start: 'top 80%',
                        toggleActions: 'play none none none'
                    },
                    opacity: 0,
                    y: 50,
                    duration: 0.8,
                    delay: i * 0.2
                });
            });
            
            // 下载区域动画
            gsap.from('#download .container > div', {
                scrollTrigger: {
                    trigger: '#download',
                    start: 'top 80%',
                    toggleActions: 'play none none none'
                },
                opacity: 0,
                y: 50,
                duration: 1
            });
        });
    </script>

    <!-- 飘雪动画 -->
    <script>
        // 雪花动画
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('snowCanvas');
            const ctx = canvas.getContext('2d');
            
            // 设置画布尺寸
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // 雪花类
            class Snowflake {
                constructor() {
                    this.reset();
                }
                
                reset() {
                    // 随机位置
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * -canvas.height;
                    
                    // 随机大小
                    this.size = Math.random() * 3 + 1;
                    
                    // 随机下落速度
                    this.speedY = Math.random() * 2 + 1;
                    
                    // 随机水平飘动
                    this.speedX = Math.random() * 2 - 0.5;
                    
                    // 随机透明度
                    this.opacity = Math.random() * 0.7 + 0.3;
                    
                    // 随机摇摆幅度
                    this.swing = Math.random() * 2 + 1;
                    this.swingAngle = Math.random() * Math.PI * 2;
                }
                
                update() {
                    // 下落
                    this.y += this.speedY;
                    
                    // 水平飘动
                    this.x += this.speedX + Math.sin(this.swingAngle) * this.swing * 0.05;
                    
                    // 摇摆动画
                    this.swingAngle += 0.05;
                    
                    // 如果雪花落到屏幕底部，重置位置
                    if (this.y > canvas.height) {
                        this.reset();
                    }
                }
                
                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
                    ctx.fill();
                    
                    // 添加雪花的闪烁效果
                    if (Math.random() > 0.7) {
                        ctx.beginPath();
                        ctx.arc(this.x - this.size * 0.5, this.y - this.size * 0.5, this.size * 0.3, 0, Math.PI * 2);
                        ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity * 0.8})`;
                        ctx.fill();
                    }
                }
            }
            
            // 创建雪花数组
            const snowflakes = [];
            const snowflakeCount = Math.floor(window.innerWidth * 0.1);
            
            for (let i = 0; i < snowflakeCount; i++) {
                snowflakes.push(new Snowflake());
            }
            
            // 动画循环
            function animate() {
                // 清除画布
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // 更新和绘制雪花
                for (const snowflake of snowflakes) {
                    snowflake.update();
                    snowflake.draw();
                }
                
                // 请求下一帧动画
                requestAnimationFrame(animate);
            }
            
            // 开始动画
            animate();
            
            // 滚动时调整雪花密度
            window.addEventListener('scroll', function() {
                const scrollPosition = window.scrollY;
                const heroHeight = document.getElementById('home').offsetHeight;
                
                // 根据滚动位置调整雪花透明度
                if (scrollPosition < heroHeight) {
                    const opacity = 0.7 - (scrollPosition / heroHeight) * 0.7;
                    canvas.style.opacity = opacity;
                } else {
                    canvas.style.opacity = 0;
                }
            });
        });
    </script>
</body>
</html>
